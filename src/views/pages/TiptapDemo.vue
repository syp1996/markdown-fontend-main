<template>
  <div class="tiptap-demo">
    <div class="demo-header">
      <h1>Tiptap ç¼–è¾‘å™¨æ¼”ç¤º</h1>
      <p>è¿™æ˜¯ä¸€ä¸ªåŸºäº Tiptap çš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ç»„ä»¶æ¼”ç¤º</p>
    </div>

    <div class="demo-content">
      <div class="demo-section">
        <h3>åŸºç¡€ HTML ç¼–è¾‘å™¨</h3>
        <TiptapEditor
          v-model="content1"
          placeholder="å¼€å§‹è¾“å…¥æ‚¨çš„å†…å®¹..."
          height="300px"
          format="html"
          @change="onContent1Change"
        />
        <div class="content-preview">
          <h4>HTML é¢„è§ˆ:</h4>
          <pre>{{ content1 }}</pre>
        </div>
        <div class="html-preview">
          <h4>æ¸²æŸ“æ•ˆæœ:</h4>
          <div v-html="content1"></div>
        </div>
      </div>

      <div class="demo-section">
        <h3>çº¯æ–‡æœ¬æ¨¡å¼ç¼–è¾‘å™¨</h3>
        <TiptapEditor
          v-model="content2"
          placeholder="è¿™ä¸ªç¼–è¾‘å™¨è¾“å‡ºçº¯æ–‡æœ¬..."
          height="250px"
          format="text"
          @change="onContent2Change"
        />
        <div class="content-preview">
          <h4>æ–‡æœ¬é¢„è§ˆ:</h4>
          <pre>{{ content2 }}</pre>
        </div>
      </div>

      <div class="demo-section">
        <h3>JSON æ ¼å¼ç¼–è¾‘å™¨</h3>
        <TiptapEditor
          v-model="content3"
          placeholder="JSON æ ¼å¼å­˜å‚¨ç¼–è¾‘å™¨çŠ¶æ€..."
          height="200px"
          format="json"
          @change="onContent3Change"
        />
        <div class="content-preview">
          <h4>JSON é¢„è§ˆ:</h4>
          <pre>{{ content3 }}</pre>
        </div>
      </div>

      <div class="demo-section">
        <h3>æ— å·¥å…·æ ç¼–è¾‘å™¨</h3>
        <TiptapEditor
          v-model="content4"
          placeholder="ä¸“æ³¨å†™ä½œæ¨¡å¼..."
          height="200px"
          :show-toolbar="false"
          @change="onContent4Change"
        />
        <div class="content-preview">
          <h4>å†…å®¹é¢„è§ˆ:</h4>
          <pre>{{ content4 }}</pre>
        </div>
      </div>

      <div class="demo-controls">
        <h3>ç¼–è¾‘å™¨æ§åˆ¶</h3>
        <div class="control-buttons">
          <button @click="clearAllEditors" class="btn btn-danger">
            æ¸…ç©ºæ‰€æœ‰ç¼–è¾‘å™¨
          </button>
          <button @click="loadSampleContent" class="btn btn-primary">
            åŠ è½½ç¤ºä¾‹å†…å®¹
          </button>
          <button @click="exportContent" class="btn btn-success">
            å¯¼å‡ºå†…å®¹
          </button>
          <button @click="copyHtml" class="btn btn-info">
            å¤åˆ¶ HTML
          </button>
        </div>
      </div>

      <div class="demo-section">
        <h3>åŠŸèƒ½è¯´æ˜</h3>
        <div class="feature-list">
          <h4>ğŸ¯ å®Œæ•´åŠŸèƒ½åˆ—è¡¨ï¼š</h4>
          <div class="feature-grid">
            <div class="feature-category">
              <h5>ğŸ“ æ–‡æœ¬æ ¼å¼</h5>
              <ul>
                <li>âœ… ç²—ä½“ã€æ–œä½“ã€<u>ä¸‹åˆ’çº¿</u>ã€åˆ é™¤çº¿</li>
                <li>âœ… <span style="color: #e74c3c">æ–‡æœ¬é¢œè‰²</span> è‡ªå®šä¹‰</li>
                <li>âœ… <mark style="background: #ffeb3b">èƒŒæ™¯é«˜äº®</mark></li>
                <li>âœ… ä¸Šæ ‡<sup>2</sup> å’Œä¸‹æ ‡<sub>2</sub></li>
                <li>âœ… <code>è¡Œå†…ä»£ç </code> é«˜äº®</li>
              </ul>
            </div>
            
            <div class="feature-category">
              <h5>ğŸ“ å¸ƒå±€ä¸å¯¹é½</h5>
              <ul>
                <li>âœ… â¬…ï¸ å·¦å¯¹é½ã€â†”ï¸ å±…ä¸­ã€â¡ï¸ å³å¯¹é½</li>
                <li>âœ… â†•ï¸ ä¸¤ç«¯å¯¹é½</li>
                <li>âœ… H1-H6 å¤šçº§æ ‡é¢˜</li>
                <li>âœ… æœ‰åº/æ— åºåˆ—è¡¨</li>
                <li>âœ… â˜‘ï¸ ä»»åŠ¡åˆ—è¡¨ï¼ˆå¯å‹¾é€‰ï¼‰</li>
              </ul>
            </div>
            
            <div class="feature-category">
              <h5>ğŸ–¼ï¸ å¤šåª’ä½“å†…å®¹</h5>
              <ul>
                <li>âœ… ğŸ”— è¶…é“¾æ¥æ’å…¥å’Œç¼–è¾‘</li>
                <li>âœ… ğŸ–¼ï¸ å›¾ç‰‡ä¸Šä¼ å’Œæ˜¾ç¤º</li>
                <li>âœ… ğŸ“Š è¡¨æ ¼åˆ›å»ºå’Œç¼–è¾‘</li>
                <li>âœ… ğŸ’» ä»£ç å—ï¼ˆè¯­æ³•é«˜äº®ï¼‰</li>
                <li>âœ… â– æ°´å¹³åˆ†å‰²çº¿</li>
              </ul>
            </div>
            
            <div class="feature-category">
              <h5>âš¡ é«˜çº§åŠŸèƒ½</h5>
              <ul>
                <li>âœ… ğŸˆ æ°”æ³¡èœå•ï¼ˆé€‰ä¸­æ–‡æœ¬æ—¶ï¼‰</li>
                <li>âœ… ğŸ“‹ æµ®åŠ¨èœå•ï¼ˆç©ºè¡Œæ—¶ï¼‰</li>
                <li>âœ… ğŸ“Š å®æ—¶å­—ç¬¦/è¯æ•°ç»Ÿè®¡</li>
                <li>âœ… ğŸ”„ æ’¤é”€/é‡åšåŠŸèƒ½</li>
                <li>âœ… âŒ¨ï¸ é”®ç›˜å¿«æ·é”®æ”¯æŒ</li>
              </ul>
            </div>
            
            <div class="feature-category">
              <h5>ğŸ”§ æŠ€æœ¯ç‰¹æ€§</h5>
              <ul>
                <li>âœ… ğŸ“¤ å¤šç§è¾“å‡ºæ ¼å¼ï¼ˆHTMLã€Textã€JSONï¼‰</li>
                <li>âœ… ğŸ¨ å¯è‡ªå®šä¹‰å·¥å…·æ å’Œæ ·å¼</li>
                <li>âœ… ğŸ“± å“åº”å¼è®¾è®¡</li>
                <li>âœ… âš›ï¸ Vue 3 å“åº”å¼é›†æˆ</li>
                <li>âœ… ğŸ§© æ¨¡å—åŒ–å¯æ‰©å±•è®¾è®¡</li>
              </ul>
            </div>
            
            <div class="feature-category">
              <h5>âœ¨ æ’ç‰ˆä¼˜åŒ–</h5>
              <ul>
                <li>âœ… è‡ªåŠ¨ç¬¦å·è½¬æ¢ï¼ˆâ†’ Â© â„¢ï¼‰</li>
                <li>âœ… æ™ºèƒ½å¼•å·å¤„ç†</li>
                <li>âœ… å¼•ç”¨å—ç¾åŒ–</li>
                <li>âœ… æ®µè½é—´è·ä¼˜åŒ–</li>
                <li>âœ… å‡ºè‰²çš„æ€§èƒ½è¡¨ç°</li>
              </ul>
            </div>
          </div>
        </div>
        
        <div class="keyboard-shortcuts">
          <h4>é”®ç›˜å¿«æ·é”®ï¼š</h4>
          <div class="shortcuts-grid">
            <div class="shortcut-item">
              <kbd>Ctrl/Cmd + B</kbd>
              <span>åŠ ç²—</span>
            </div>
            <div class="shortcut-item">
              <kbd>Ctrl/Cmd + I</kbd>
              <span>æ–œä½“</span>
            </div>
            <div class="shortcut-item">
              <kbd>Ctrl/Cmd + U</kbd>
              <span>åˆ é™¤çº¿</span>
            </div>
            <div class="shortcut-item">
              <kbd>Ctrl/Cmd + Z</kbd>
              <span>æ’¤é”€</span>
            </div>
            <div class="shortcut-item">
              <kbd>Ctrl/Cmd + Shift + Z</kbd>
              <span>é‡åš</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import TiptapEditor from '@/components/TiptapEditor.vue';

export default {
  name: 'TiptapDemo',
  components: {
    TiptapEditor
  },
  data() {
    return {
      content1: '',
      content2: '',
      content3: '',
      content4: '',
      sampleHtml: `<h1 style="text-align: center">ğŸ‰ å®Œæ•´åŠŸèƒ½ç‰ˆ Tiptap ç¼–è¾‘å™¨ï¼</h1>
<p>è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼ŒåŒ…å«<strong>æ‰€æœ‰å…è´¹åŠŸèƒ½</strong>ï¼</p>

<h2>ğŸ“ æ–‡æœ¬æ ¼å¼åŠŸèƒ½</h2>
<ul>
  <li><strong>ç²—ä½“</strong> å’Œ <em>æ–œä½“</em> æ–‡æœ¬</li>
  <li><u>ä¸‹åˆ’çº¿</u> å’Œ <s>åˆ é™¤çº¿</s> æ ¼å¼</li>
  <li><span style="color: #e74c3c">å½©è‰²æ–‡æœ¬</span> å’Œ <mark class="tiptap-highlight">èƒŒæ™¯é«˜äº®</mark></li>
  <li>åŒ–å­¦å…¬å¼ï¼šH<sub>2</sub>O å’Œæ•°å­¦å…¬å¼ï¼šE=mc<sup>2</sup></li>
  <li><code>è¡Œå†…ä»£ç </code> é«˜äº®</li>
</ul>

<h2>ğŸ“Š ç»“æ„åŒ–å†…å®¹</h2>
<p>æ”¯æŒå¤šç§å¯¹é½æ–¹å¼ï¼š</p>
<p style="text-align: left">â¬…ï¸ å·¦å¯¹é½æ–‡æœ¬</p>
<p style="text-align: center">â†”ï¸ å±…ä¸­å¯¹é½æ–‡æœ¬</p>
<p style="text-align: right">â¡ï¸ å³å¯¹é½æ–‡æœ¬</p>

<h3>ä»»åŠ¡åˆ—è¡¨ç¤ºä¾‹</h3>
<ul data-type="taskList">
  <li data-type="taskItem" data-checked="true">âœ… å®ç°åŸºç¡€æ–‡æœ¬æ ¼å¼</li>
  <li data-type="taskItem" data-checked="true">âœ… æ·»åŠ è¡¨æ ¼åŠŸèƒ½</li>
  <li data-type="taskItem" data-checked="false">â¬œ æŒç»­ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ</li>
</ul>

<h3>ä»£ç å—æ¼”ç¤º</h3>
<pre class="tiptap-code-block"><code>function greetUser(name) {
  console.log(\`Hello, \${name}!\`);
  return \`Welcome to Tiptap Editor!\`;
}</code></pre>

<hr>

<h3>åŠŸèƒ½å¯¹æ¯”è¡¨æ ¼</h3>
<table>
  <tr>
    <th>åŠŸèƒ½ç±»åˆ«</th>
    <th>åŒ…å«åŠŸèƒ½</th>
    <th>çŠ¶æ€</th>
  </tr>
  <tr>
    <td>æ–‡æœ¬æ ¼å¼</td>
    <td>ç²—ä½“ã€æ–œä½“ã€ä¸‹åˆ’çº¿ã€åˆ é™¤çº¿ã€é¢œè‰²ã€é«˜äº®</td>
    <td>âœ… å®Œæˆ</td>
  </tr>
  <tr>
    <td>ç»“æ„å…ƒç´ </td>
    <td>æ ‡é¢˜ã€åˆ—è¡¨ã€ä»»åŠ¡åˆ—è¡¨ã€å¼•ç”¨ã€ä»£ç å—</td>
    <td>âœ… å®Œæˆ</td>
  </tr>
  <tr>
    <td>å¤šåª’ä½“</td>
    <td>é“¾æ¥ã€å›¾ç‰‡ã€è¡¨æ ¼</td>
    <td>âœ… å®Œæˆ</td>
  </tr>
  <tr>
    <td>é«˜çº§åŠŸèƒ½</td>
    <td>æ°”æ³¡èœå•ã€æµ®åŠ¨èœå•ã€å­—ç¬¦ç»Ÿè®¡ã€å¯¹é½</td>
    <td>âœ… å®Œæˆ</td>
  </tr>
</table>

<blockquote>
  <p>ğŸš€ ç°åœ¨æ‚¨æ‹¥æœ‰äº†ä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€ä¸“ä¸šçº§çš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼</p>
</blockquote>

<p><a href="https://tiptap.dev" class="tiptap-link">äº†è§£æ›´å¤š Tiptap åŠŸèƒ½</a></p>`,
      sampleText: `æ¬¢è¿ä½¿ç”¨ Tiptap ç¼–è¾‘å™¨ï¼

è¿™æ˜¯ä¸€ä¸ªåŸºäº ProseMirror çš„ç°ä»£å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ã€‚

ä¸»è¦ç‰¹æ€§ï¼š
- æ¨¡å—åŒ–è®¾è®¡ - æŒ‰éœ€å¼•å…¥åŠŸèƒ½
- ä¸°å¯Œçš„æ‰©å±• - æ”¯æŒå„ç§æ–‡æœ¬æ ¼å¼
- å¼€å‘è€…å‹å¥½ - æ˜“äºé›†æˆå’Œå®šåˆ¶
- å‡ºè‰²çš„æ€§èƒ½ - æµç•…çš„ç¼–è¾‘ä½“éªŒ

å¼€å§‹ä½“éªŒå§ï¼`,
      sampleJson: '{"type":"doc","content":[{"type":"heading","attrs":{"level":1},"content":[{"type":"text","text":"JSON æ ¼å¼æ¼”ç¤º"}]},{"type":"paragraph","content":[{"type":"text","text":"Tiptap æ”¯æŒä»¥ JSON æ ¼å¼å­˜å‚¨ç¼–è¾‘å™¨çŠ¶æ€ã€‚"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"paragraph","content":[{"type":"text","text":"ç»“æ„åŒ–æ•°æ®å­˜å‚¨"}]}]},{"type":"listItem","content":[{"type":"paragraph","content":[{"type":"text","text":"ç‰ˆæœ¬æ§åˆ¶å‹å¥½"}]}]},{"type":"listItem","content":[{"type":"paragraph","content":[{"type":"text","text":"æ˜“äºæ•°æ®å¤„ç†"}]}]}]}]}',
      focusContent: `ä¸“æ³¨å†™ä½œæ¨¡å¼

åœ¨è¿™ä¸ªæ¨¡å¼ä¸‹æ²¡æœ‰å·¥å…·æ å¹²æ‰°ï¼Œ
è®©æ‚¨ä¸“æ³¨äºå†…å®¹åˆ›ä½œã€‚

é€‚åˆç”¨äºï¼š
- é•¿æ–‡å†™ä½œ
- æ€ç»´æ•´ç†
- å¿«é€Ÿè®°å½•`
    }
  },
  methods: {
    onContent1Change(content) {
      console.log('HTMLå†…å®¹å˜åŒ–:', content);
    },
    onContent2Change(content) {
      console.log('æ–‡æœ¬å†…å®¹å˜åŒ–:', content);
    },
    onContent3Change(content) {
      console.log('JSONå†…å®¹å˜åŒ–:', content);
    },
    onContent4Change(content) {
      console.log('ä¸“æ³¨æ¨¡å¼å†…å®¹å˜åŒ–:', content);
    },
    clearAllEditors() {
      this.content1 = '';
      this.content2 = '';
      this.content3 = '';
      this.content4 = '';
      if (this.$message) {
        this.$message.success('æ‰€æœ‰ç¼–è¾‘å™¨å·²æ¸…ç©º');
      } else {
        alert('æ‰€æœ‰ç¼–è¾‘å™¨å·²æ¸…ç©º');
      }
    },
    loadSampleContent() {
      this.content1 = this.sampleHtml;
      this.content2 = this.sampleText;
      this.content3 = this.sampleJson;
      this.content4 = this.focusContent;
      if (this.$message) {
        this.$message.success('ç¤ºä¾‹å†…å®¹å·²åŠ è½½');
      } else {
        alert('ç¤ºä¾‹å†…å®¹å·²åŠ è½½');
      }
    },
    exportContent() {
      const exportData = {
        html: this.content1,
        text: this.content2,
        json: this.content3,
        focus: this.content4,
        timestamp: new Date().toISOString()
      };
      
      const blob = new Blob([JSON.stringify(exportData, null, 2)], {
        type: 'application/json'
      });
      
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `tiptap-content-${Date.now()}.json`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      
      if (this.$message) {
        this.$message.success('å†…å®¹å·²å¯¼å‡º');
      } else {
        alert('å†…å®¹å·²å¯¼å‡º');
      }
    },
    async copyHtml() {
      try {
        await navigator.clipboard.writeText(this.content1);
        if (this.$message) {
          this.$message.success('HTML å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
        } else {
          alert('HTML å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
        }
      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);
        if (this.$message) {
          this.$message.error('å¤åˆ¶å¤±è´¥');
        } else {
          alert('å¤åˆ¶å¤±è´¥');
        }
      }
    }
  }
}
</script>

<style scoped>
.tiptap-demo {
  padding: 20px;
  max-width: 1200px;
  margin: 0 auto;
}

.demo-header {
  text-align: center;
  margin-bottom: 40px;
}

.demo-header h1 {
  color: #2c3e50;
  margin-bottom: 10px;
  font-size: 28px;
}

.demo-header p {
  color: #7f8c8d;
  font-size: 16px;
}

.demo-content {
  display: flex;
  flex-direction: column;
  gap: 30px;
}

.demo-section {
  background: white;
  border-radius: 8px;
  padding: 20px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.demo-section h3 {
  color: #34495e;
  margin-bottom: 15px;
  border-bottom: 2px solid #e74c3c;
  padding-bottom: 8px;
}

.content-preview {
  margin-top: 20px;
  padding: 15px;
  background: #f8f9fa;
  border-radius: 6px;
}

.content-preview h4 {
  color: #495057;
  margin-bottom: 10px;
  font-size: 14px;
}

.content-preview pre {
  background: #2d3748;
  color: #e2e8f0;
  padding: 12px;
  border-radius: 4px;
  max-height: 200px;
  overflow-y: auto;
  font-size: 12px;
  line-height: 1.4;
  margin: 0;
  white-space: pre-wrap;
  word-break: break-all;
}

.html-preview {
  margin-top: 15px;
  padding: 15px;
  background: #ffffff;
  border: 1px solid #dee2e6;
  border-radius: 6px;
}

.html-preview h4 {
  color: #495057;
  margin-bottom: 10px;
  font-size: 14px;
}

.html-preview div {
  min-height: 50px;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  line-height: 1.6;
}

.demo-controls {
  background: #f8f9fa;
  border-radius: 8px;
  padding: 20px;
  border: 1px solid #e9ecef;
}

.control-buttons {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

.btn {
  padding: 10px 20px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
  transition: all 0.2s;
}

.btn-primary {
  background: #007bff;
  color: white;
}

.btn-primary:hover {
  background: #0056b3;
}

.btn-success {
  background: #28a745;
  color: white;
}

.btn-success:hover {
  background: #1e7e34;
}

.btn-danger {
  background: #dc3545;
  color: white;
}

.btn-danger:hover {
  background: #c82333;
}

.btn-info {
  background: #17a2b8;
  color: white;
}

.btn-info:hover {
  background: #138496;
}

.feature-list {
  background: #f8f9fa;
  padding: 20px;
  border-radius: 6px;
  margin-bottom: 20px;
}

.feature-list h4 {
  color: #495057;
  margin-bottom: 15px;
}

.feature-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 20px;
  margin-top: 15px;
}

.feature-category {
  background: white;
  border: 1px solid #e9ecef;
  border-radius: 8px;
  padding: 15px;
}

.feature-category h5 {
  color: #495057;
  margin-bottom: 10px;
  font-size: 16px;
  border-bottom: 2px solid #e9ecef;
  padding-bottom: 5px;
}

.feature-category ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.feature-category li {
  padding: 4px 0;
  color: #495057;
  font-size: 14px;
  line-height: 1.4;
}

.feature-list ul {
  list-style: none;
  padding: 0;
}

.feature-list li {
  padding: 5px 0;
  color: #495057;
}

.keyboard-shortcuts {
  background: #e9ecef;
  padding: 20px;
  border-radius: 6px;
}

.keyboard-shortcuts h4 {
  color: #495057;
  margin-bottom: 15px;
}

.shortcuts-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 10px;
}

.shortcut-item {
  display: flex;
  align-items: center;
  gap: 10px;
}

.shortcut-item kbd {
  background: #343a40;
  color: white;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 11px;
  font-family: monospace;
  border: 1px solid #495057;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.shortcut-item span {
  color: #495057;
  font-size: 14px;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
  .tiptap-demo {
    padding: 15px;
  }
  
  .demo-header h1 {
    font-size: 24px;
  }
  
  .demo-section {
    padding: 15px;
  }
  
  .control-buttons {
    flex-direction: column;
  }
  
  .btn {
    width: 100%;
  }
  
  .shortcuts-grid {
    grid-template-columns: 1fr;
  }
}
</style>
